let _ADVNCD_GLOBAL_KEY="",_ADVNCD_GLOBAL_ERROR_RESPONSE="",_ADVNCD_GLOBAL_SUCCESS_RESPONSE="",_ADVNCD_MAIN_LIST_URL="",_ADVNCD_CREATE_URL="",_ADVNCD_UPDATE_URL="",_ADVNCD_DELETE_URL="",_ADVNCD_MAIN_TABLE=null,_ADVNCD_MAIN_DATA=[],_ADVNCD_INPUT_DATA=[];function _AdvncdDoDeleteData(){$("#_AdvncdBtnKampretDoDelete").prop("disabled",!0).html("loading...");var t=$("#_idAdvncdModalInput").val();window.location.href=_ADVNCD_DELETE_URL+"/"+t}async function _AdvncdDoAddEditData(t=null){const e=$("#_inpt_"+_ADVNCD_GLOBAL_KEY).val(),a=null!=e;$("._kampretScreenErrorMessage").remove();let n={};_ADVNCD_INPUT_DATA.map(((t,e)=>{const d=$(`#_inpt_${t?.name}`).val();n[t?.name]=d;let i="string"!=typeof t?.inputValidation?"":null!=t?.inputValidation?t?.inputValidation:"";i=a?null!=t?.inputValidation?.update?t?.inputValidation?.update:i:null!=t?.inputValidation?.create?t?.inputValidation?.create:i;(""!=i||null!=i?_validateInput(i.split("|"),d):[]).map(((e,a)=>$(`#_inpt_${t?.name}`).parent(".input-group, .form-group").after('<p class="_kampretScreenErrorMessage text-danger">'+e+"</p>")))})),$("._kampretScreenErrorMessage").length<=0&&($(t).attr("disabled",!0).html("Loading.."),a&&(n[_ADVNCD_GLOBAL_KEY]=e),await $.ajax({url:a?_ADVNCD_UPDATE_URL:_ADVNCD_CREATE_URL,type:"POST",data:n,async:!0,cache:!1,success:function(e){let a=!0;if(null!=(e=$.parseJSON(e))[_ADVNCD_GLOBAL_ERROR_RESPONSE]&&e[_ADVNCD_GLOBAL_ERROR_RESPONSE].length>0&&"string"!=typeof e[_ADVNCD_GLOBAL_ERROR_RESPONSE]){let t="";e[_ADVNCD_GLOBAL_ERROR_RESPONSE].map(((e,a)=>t+=`${e}<br />`)),t.length>0&&(setMessage("Warning","warning",t),a=!1)}if(a){if(null!=e[_ADVNCD_GLOBAL_SUCCESS_RESPONSE]&&e[_ADVNCD_GLOBAL_SUCCESS_RESPONSE].length>0&&"string"!=typeof e[_ADVNCD_GLOBAL_SUCCESS_RESPONSE]){let t="";e[_ADVNCD_GLOBAL_SUCCESS_RESPONSE].map(((e,a)=>t+=`${e}<br />`)),setMessage("Success","success",t)}$("#_AdvncdKampretAddEditForm").hide(),$("#_AdvncdKampretTableBox").show(),$("#_AdvncdKampretBtnAdd").show()}_AdvncdChangeFilter(),$(t).attr("disabled",!1).html('<i class="fa fa-check"></i> Save')},error:function(e,a){$(t).attr("disabled",!1).html('<i class="fa fa-check"></i> Save')}}))}function _AdvncdGenerateBtnAdd(){return'<a href="#" data-id="" data-row="0" class="btn btn-primary btn-sm _btnAdvncdKampretAddEdit"><i class="fa fa-plus"></i> New Data</a>',"</div></div>",'<div id="_AdvncdKampretBtnAdd" class="row" style="margin-bottom:20px"><div class="col-sm-12"><a href="#" data-id="" data-row="0" class="btn btn-primary btn-sm _btnAdvncdKampretAddEdit"><i class="fa fa-plus"></i> New Data</a></div></div>'}function _AdvncdGenerateSearchBox(){return'<div class="col-sm-3 offset-9">','<div class="input-group">','<input type="text" class="form-control" id="_kampretAdvncdSearchBox" placeholder="Search">','<span class="input-group-btn">','<button type="button" id="_kampretAdvncdSearchBoxButton" class="btn btn-primary btn-search">','<i class="fa fa-search"></i>',"</button>","</span>","</div>","</div>","</div>","<br />",'<div class="row"><div class="col-sm-3 offset-9"><div class="input-group"><input type="text" class="form-control" id="_kampretAdvncdSearchBox" placeholder="Search"><span class="input-group-btn"><button type="button" id="_kampretAdvncdSearchBoxButton" class="btn btn-primary btn-search"><i class="fa fa-search"></i></button></span></div></div></div><br />'}function _AdvncdGenerateModalDelete(){return'<div class="modal-dialog" role="document">','<div class="modal-content">','<div class="modal-header">','<input type="hidden" id="_idAdvncdModalInput">','<h4 class="modal-title">Are you sure to delete this data?</h4>','<button type="button" class="close" data-dismiss="modal" aria-label="Close">','<span aria-hidden="true">&times;</span>','<span class="sr-only">Close</span>',"</button>","</div>",'<div class="modal-footer">','<button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-close"></i> Cancel</button>','<button type="button" onclick="_AdvncdDoDeleteData()" id="_AdvncdBtnKampretDoDelete" class="btn btn-primary"><i class="fa fa-check"></i> Save</button>',"</div>","</div>","</div>","</div>",'<div class="modal fade" id="_AdvncdKampretDeleteModal"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><input type="hidden" id="_idAdvncdModalInput"><h4 class="modal-title">Are you sure to delete this data?</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div><div class="modal-footer"><button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-close"></i> Cancel</button><button type="button" onclick="_AdvncdDoDeleteData()" id="_AdvncdBtnKampretDoDelete" class="btn btn-primary"><i class="fa fa-check"></i> Save</button></div></div></div></div>'}function _AdvncdGenerateFormAddEdit(){return'<div id="_AdvncdKampretAddEditFormBody"></div>',"</div>",'<div id="_AdvncdKampretAddEditForm"><div id="_AdvncdKampretAddEditFormBody"></div></div>'}function _AdvncdCloseFormAddEdit(){$("#_AdvncdKampretAddEditForm").hide(),$("#_AdvncdKampretBtnAdd").show(),$("#_AdvncdKampretTableBox").show()}function _AdvncdRenderKampretTable(t=[],e=[],a="",n={},d=[]){var i={datatype:"json",datafields:t,cache:!1,async:!0,search:{caption:"Search...",Find:"Find",Reset:"Reset",odata:["equal","not equal","less","less or equal","greater","greater or equal","begins with","does not begin with","is in","is not in","ends with","does not end with","contains","does not contain"]},url:_ADVNCD_MAIN_LIST_URL+"?onchange=false",root:"Rows",beforeprocessing:function(t){null!=t?.Rows&&t?.Rows.map(((e,i)=>{let l="";d.map(((t,n)=>{null!=t?.label&&null!=t?.action&&null!=e[a]&&(l+=`<a href="${t.action}/${e[a]}" class="btn-jqxgrid ${t?.class}">${t.label}</a>`)})),null!=n?.update&&null!=e[a]&&(l+=`<a href="#" data-id="${e[a]}" data-row="${i+1}" class="btn btn-sm _btnAdvncdKampretAddEdit btn-jqxgrid btn-info"><i class="fa fa-edit"></i></a>`),null!=n?.delete&&null!=e[a]&&(l+=`<a href="#" data-id="${e[a]}" class="btn btn-sm _btnAdvncdKampretDelete btn-jqxgrid btn-danger" data-toggle="modal"><i class="fa fa-trash"></i></a>`),t.Rows[i].actions=l})),i.totalrecords=t.TotalRows,_ADVNCD_MAIN_DATA=t.Rows},filter:function(){$("#_myAdvncdKampretTable").jqxGrid("updatebounddata","filter")},sort:function(){$("#_myAdvncdKampretTable").jqxGrid("updatebounddata","sort")}},l=new $.jqx.dataAdapter(i);$("#_myAdvncdKampretTable").jqxGrid({width:"100%",source:l,filterable:!0,theme:"classic",autoheight:!1,pageable:!0,virtualmode:!0,rowsheight:30,sortable:!0,columnsresize:!0,enablebrowserselection:!0,rendergridrows:function(t){return t.data},columns:e})}function _AdvncdChangeFilter(){var t=$("#_kampretAdvncdSearchBox").val(),e=_MAIN_TABLE.jqxGrid("source");e._source.url=_ADVNCD_MAIN_LIST_URL+"?onchange=true&keywords="+t,_MAIN_TABLE.jqxGrid("gotopage",0),_MAIN_TABLE.jqxGrid("source",e)}!function(t){t.fn.advancedTableKampret=function(e){const a=t.extend({key:null,actions:{},additionalButton:[],fieldAttributes:{},fields:[]},e);if(a.fields.length>0&&""!=a.key&&a.key){$(this);var n="";if(null!=a.actions?.create&&(n+=_AdvncdGenerateBtnAdd(a.actions.create)),null!=a.actions?.list){_ADVNCD_GLOBAL_KEY=a.key,_ADVNCD_MAIN_LIST_URL=a.actions?.list,_ADVNCD_CREATE_URL=a.actions?.create,_ADVNCD_UPDATE_URL=a.actions?.update,_ADVNCD_DELETE_URL=a.actions?.delete,_ADVNCD_GLOBAL_ERROR_RESPONSE=null!=a.actions?.errorResponse?a.actions?.errorResponse:"_____",_ADVNCD_GLOBAL_SUCCESS_RESPONSE=null!=a.actions?.successResponse?a.actions?.successResponse:"_____",n+=_AdvncdGenerateModalDelete(),n+=_AdvncdGenerateFormAddEdit(),n+='<div id="_AdvncdKampretTableBox">',n+=_AdvncdGenerateSearchBox(),n+='<div id="_myAdvncdKampretTable"></div>',n+="</div>",$(this).html(n),$("#_kampretAdvncdSearchBox").keyup((function(t){"13"==(t.keyCode?t.keyCode:t.which)&&_AdvncdChangeFilter()})),$("#_kampretAdvncdSearchBox").click((function(t){_AdvncdChangeFilter()})),$(document).on("click","._btnAdvncdKampretDelete",(function(){const t=$(this).data("id");$("#_idAdvncdModalInput").val(t),$("#_AdvncdKampretDeleteModal").modal("show")})),$(document).on("click","._btnAdvncdKampretAddEdit",(function(){const t=$(this).data("id"),e=parseInt($(this).data("row"))-1;let n=[];if(a.fields.map(((t,e)=>{null!=t?.name&&null!=t?.inputAttributes?.componentId&&n.push({name:t.name,componentId:t.inputAttributes.componentId,inputLabel:t.inputAttributes.inputLabel,column:t.inputAttributes.column,inputValidation:t.inputAttributes.inputValidation,readonly:t.inputAttributes.readonly,defaultValue:""})})),null!=_ADVNCD_MAIN_DATA[e]){const t=_ADVNCD_MAIN_DATA[e];n.map(((e,a)=>{null!=t[e.name]&&(n[a].defaultValue=t[e.name])}))}_ADVNCD_INPUT_DATA=n;var d=1;null!=a.fieldAttributes?.columns&&a.fieldAttributes?.columns>0&&a.fieldAttributes?.columns<=6&&(d=a.fieldAttributes?.columns);var i='<div class="row">';e>=0&&(i+='<input type="hidden" id="_inpt_'+a.key+'" name="'+a.key+'" value="'+t+'" />');const l=d>0?Math.ceil(12/d):12;for(let t=1;t<=d;++t)i+='<div class="col-'+l+'">',n.map(((e,a)=>{if(e?.column==t){const t=null!=e?.defaultValue?e?.defaultValue:"",a=null!=e?.inputLabel?e?.inputLabel:e?.name,n=e?.readonly?"readonly":"";null!=e?.componentId&&(i+='<Component label="'+a+'" data-element="'+e?.componentId+'" name="'+e?.name+'" defaultValue="'+t+'" '+n+"></Component>")}})),i+="</div>";i+="</div>",i+='<div class="row">',i+='<div class="col-sm-2 offset-8">',i+='<button type="button" onclick="_AdvncdCloseFormAddEdit()" class="btn btn-block btn-sm btn-danger"><i class="fa fa-arrow-left"></i> Back to List</button>',i+="</div>",i+='<div class="col-sm-2">',i+='<button type="button" onclick="_AdvncdDoAddEditData(this)" class="btn btn-block btn-primary"><i class="fa fa-check"></i> Save</button>',i+="</div>",i+="</div>",$("#_AdvncdKampretAddEditFormBody").html(i),generateKampretComponent(),$("#_AdvncdKampretBtnAdd").hide(),$("#_AdvncdKampretTableBox").hide(),$("#_AdvncdKampretAddEditForm").show()})),_MAIN_TABLE=$("#_myAdvncdKampretTable");var d=[],i=[];$.each(a.fields,(function(t,e){if(null!=e?.tableAttributes&&null!=e?.name){d.push({name:e.name});let t={datafield:e?.name,text:null!=e?.tableAttributes?.headerText?e?.tableAttributes?.headerText:e?.name,sortable:null==e?.tableAttributes?.sortable||e?.tableAttributes?.sortable,filterable:null==e?.tableAttributes?.filterable||e?.tableAttributes?.filterable};null!=e?.tableAttributes?.width&&(t.width=e?.tableAttributes?.width),i.push(t)}})),(null!=a.actions?.update||null!=a.actions?.delete||a.additionalButton.length>0)&&(d.push({name:"actions"}),i.push({datafield:"actions",text:"Actions",sortable:!1,filterable:!1})),_AdvncdRenderKampretTable(d,i,a.key,a.actions,a.additionalButton)}else $(this).html(n)}}}(jQuery);